<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bingo Literario</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; 
            margin: 0;
            display: flex;
            justify-content: center;  /* centra horizontalmente */
            align-items: center;      /* centra verticalmente */
            color: #333;
            padding: 20px; /* opcional, para que no toque los bordes */
        }

        .container {
            width: 100%;
            max-width: 800px; /* ancho fijo razonable para centrar */
            background: white;
            border-radius: 20px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
}

        .header { background: linear-gradient(135deg, #2c3e50, #3498db); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.1rem; opacity: 0.9; }
        .main-content { display: grid; /*grid-template-columns: 2fr 1fr;*/ gap: 40px; padding: 40px; }
        .bingo-section { display: flex; flex-direction: column; align-items: center; }
        .bingo-controls { margin-bottom: 20px; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; }
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none;
            padding: 12px 24px; border-radius: 25px; cursor: pointer; font-size: 1rem; font-weight: 600;
            transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102,126,234,0.3);
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(102,126,234,0.4); }
        .btn:active { transform: translateY(0); }
        .bingo-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 3px; background: #2c3e50; padding: 10px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .bingo-cell {
            background: white; border: 2px solid #ecf0f1; padding: 15px 8px; text-align: center;
            font-size: 0.85rem; font-weight: 600; min-height: 80px; display: flex; align-items: center;
            justify-content: center; cursor: pointer; transition: all 0.3s ease; border-radius: 8px; line-height: 1.2;
            user-select: none;
        }
        .bingo-cell:hover { background: #f8f9fa; transform: scale(1.02); }
        .bingo-cell.marked { background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; border-color: #27ae60; transform: scale(0.95); }
        .bingo-cell.free { background: linear-gradient(135deg, #95a5a6, #7f8c8d); color: white; border-color: #95a5a6; font-weight: bold; cursor: default; }
        .bingo-cell.flash-correct { animation: flashGreen 400ms ease; }
        .bingo-cell.flash-wrong { animation: flashRed 400ms ease; }
        @keyframes flashGreen { from { box-shadow: 0 0 0 rgba(39,174,96,0); } to { box-shadow: 0 0 20px rgba(39,174,96,0.9); } }
        @keyframes flashRed { from { box-shadow: 0 0 0 rgba(231,76,60,0); } to { box-shadow: 0 0 20px rgba(231,76,60,0.9); } }
        .current-ball {
            background: linear-gradient(135deg, #f39c12, #e67e22); color: white; padding: 20px; border-radius: 15px;
            text-align: center; margin: 20px 0; box-shadow: 0 10px 30px rgba(243,156,18,0.3);
        }
        .current-ball h3 { margin-bottom: 15px; font-size: 1.2rem; }
        .ball-display { background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; font-size: 1.1rem; font-weight: bold; min-height: 50px; display: flex; align-items: center; justify-content: center; text-align: center; }
        .drawn-balls { background: #ecf0f1; padding: 15px; border-radius: 10px; margin-top: 20px; max-height: 200px; overflow-y: auto; width: 100%; }
        .drawn-balls h4 { color: #2c3e50; margin-bottom: 10px; }
        .ball-list { display: flex; flex-wrap: wrap; gap: 8px; }
        .ball-item { background: #3498db; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.85rem; font-weight: 600; }
        .stats { background: #ecf0f1; padding: 15px; border-radius: 10px; margin-top: 20px; text-align: center; width: 100%; }
        .stats p { margin: 5px 0; color: #2c3e50; font-weight: 600; }
        @media (max-width: 768px) {
            .main-content { grid-template-columns: 1fr; gap: 30px; padding: 20px; }
            .header h1 { font-size: 2rem; }
            .bingo-cell { font-size: 0.75rem; min-height: 60px; padding: 8px 4px; }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üéØ Bingo Literario</h1>
        <p>Juego educativo: selecciona la respuesta correcta cuando aparezca la pregunta</p>
    </div>

    <div class="main-content">
        <div class="bingo-section">
            <div class="bingo-controls">
                <button class="btn" id="gameBtn" onclick="startGame()">‚ñ∂Ô∏è Iniciar Juego</button>
                <button class="btn" onclick="resetGame()">üîÑ Reiniciar Juego</button>
            </div>

            <div class="current-ball" id="currentBall">
                <h3>Pr√≥xima pregunta en: <span id="countdown">20</span>s</h3>
                <div class="ball-display" id="ballDisplay">¬°Presiona "Iniciar Juego" y luego haz clic en la respuesta correcta!</div>
            </div>

            <div id="bingoGrid" class="bingo-grid"></div>

            <div class="stats">
                <p>T√©rminos disponibles: <span id="termCount">0</span></p>
                <p>Casillas marcadas: <span id="markedCount">0</span></p>
                <p>Preguntas respondidas: <span id="drawnCount">0</span></p>
                <p>Errores: <span id="errorCount">0</span>/3</p>
            </div>

            <div class="drawn-balls">
                <h4>üé± Preguntas sorteadas:</h4>
                <div class="ball-list" id="drawnBallsList"></div>
            </div>
        </div>

        <!-- Columna derecha vac√≠a para dise√±o limpio (sin carga de Excel) -->
        <div></div>
    </div>
</div>

<script>
// --- Banco fijo de preguntas/respuestas (solo por c√≥digo) ---
let literaryQuestions = {
  "Fresia":"Personaje femenino de La Araucana cuyo nombre comienza con 'f'",
  "Juan M√°laga o Rodrigo de Quiroga":"Esposo de In√©s Su√°rez",
  "Al g√©nero L√≠rico":"¬øA qu√© g√©nero pertenece la figura \'yo l√≠rico o yo po√©tico\'?",
  "En tres partes":"¬øEn cu√°ntas partes se divide La Araucana?",
  "L√≠rico o √âpico o Epopeya":"G√©nero de La Araucana",
  "Novela":"Subg√©nero de In√©s del alma m√≠a",
  "Pedro de Valdivia":"Gobernador de Chile mencionado en In√©s del alma m√≠a",
  "Lautaro":"Personaje que se describe como: 'industrioso, sabio, presto, de gran consejo, manso de condici√≥n y hermoso gesto'",
  "B√≠o-B√≠o":"R√≠o que se menciona en La Araucana y que empieza con 'b'",
  "A Dido":"¬øA qu√© personaje femenino de la Literatura Universal se menciona en La Araucana?",
  "De Sevilla":"Lugar de donde zarpa el barco que lleva a In√©s al Nuevo Mundo",
  "Met√°fora":"¬øEsta cita corresponde a una met√°fora/ metonimia/ s√≠mil/ prosopopeya? 'ro√≠an poco a poco la heredad ind√≠gena, en lugar de hacerlo con violencia abierta'",
};

// --- Estado de juego ---
let drawnBalls = [];
let remainingBalls = Object.keys(literaryQuestions);
let gameInterval = null;
let isGameRunning = false;
let currentCard = [];
let currentQuestion = null; // guarda la respuesta correcta (clave del objeto)
let errorCount = 0;
let maxErrors = 3;

function initializeGame() {
    generateNewCard();
    updateStats();
}

function generateNewCard() {
    const grid = document.getElementById('bingoGrid');
    const totalCells = 9; // 3x3 fijo

    // preparar posiciones y t√©rminos
    const keys = Object.keys(literaryQuestions);
    const shuffled = [...keys].sort(() => Math.random() - 0.5);
    const selected = shuffled.slice(0, 8); // 8 t√©rminos (el centro es libre)

    // construir contenido con centro libre ya marcado
    const content = new Array(totalCells).fill(null);
    const positions = [0,1,2,3,5,6,7,8]; // sin el centro (4)
    positions.sort(() => Math.random() - 0.5);
    positions.forEach((pos, i) => { content[pos] = selected[i]; });
    content[4] = 'FREE';
    currentCard = [...content];

    // render
    grid.style.gridTemplateColumns = `repeat(3, 1fr)`;
    grid.innerHTML = '';
    for (let i = 0; i < totalCells; i++) {
        const cell = document.createElement('div');
        cell.className = 'bingo-cell';
        cell.dataset.index = i;

        if (i === 4) { // centro libre
            cell.textContent = '';
            cell.className += ' free marked';
        } else {
            cell.textContent = content[i];
            cell.addEventListener('click', () => handleCellClick(cell));
        }
        grid.appendChild(cell);
    }
    updateStats();
}

function handleCellClick(cell) {
    if (cell.classList.contains('free')) return;
    if (!currentQuestion) return; // no hay pregunta activa

    // Validaci√≥n manual: el usuario decide y hace clic. El sistema valida.
    if (cell.textContent === currentQuestion) {
        cell.classList.add('marked');
cell.classList.add('flash-correct');
setTimeout(() => cell.classList.remove('flash-correct'), 450);
currentQuestion = null; 
document.getElementById('ballDisplay').textContent = '¬°Correcto! Pr√≥xima pregunta en 5 segundos‚Ä¶';
updateStats();
checkBingo();

// Reinicia temporizador con 5 segundos
clearInterval(gameInterval);
let countdown = 5;
document.getElementById('countdown').textContent = countdown;
gameInterval = setInterval(() => {
    countdown--;
    document.getElementById('countdown').textContent = countdown;
    if (countdown <= 0) {
        drawBall();
        countdown = 20; // vuelve a 20 segundos para la siguiente pregunta
    }
}, 1000);

    } else {
        errorCount++;
        cell.classList.add('flash-wrong');
        setTimeout(() => cell.classList.remove('flash-wrong'), 450);
        updateStats();
        if (errorCount >= maxErrors) {
            stopGame();
            document.getElementById('ballDisplay').textContent = '‚ùå Has cometido demasiados errores. Fin del juego.';
        }
    }
}

function startGame() {
    if (remainingBalls.length === 0) { resetGame(); }

    isGameRunning = true;
    const btn = document.getElementById('gameBtn');
    btn.innerHTML = '‚è∏Ô∏è Pausar Juego';
    btn.onclick = stopGame;

    // sacar primera pregunta al iniciar
    drawBall();

    // temporizador
    let countdown = 20;
    document.getElementById('countdown').textContent = countdown;
    clearInterval(gameInterval);
    gameInterval = setInterval(() => {
        countdown--;
        document.getElementById('countdown').textContent = countdown;
        if (countdown <= 0) {
            drawBall();
            countdown = 20;
        }
    }, 1000);
}

function stopGame() {
    isGameRunning = false;
    clearInterval(gameInterval);
    const btn = document.getElementById('gameBtn');
    btn.innerHTML = '‚ñ∂Ô∏è Continuar Juego';
    btn.onclick = startGame;
    document.getElementById('countdown').textContent = '20';
}

function resetGame() {
    stopGame();
    drawnBalls = [];
    remainingBalls = [...Object.keys(literaryQuestions)];
    currentQuestion = null;
    errorCount = 0;

    document.getElementById('ballDisplay').textContent = '¬°Presiona "Iniciar Juego" y luego haz clic en la respuesta correcta!';
    const list = document.getElementById('drawnBallsList');
    list.innerHTML = '';

    // limpiar marcas del cart√≥n excepto la libre
    document.querySelectorAll('.bingo-cell').forEach((cell, idx) => {
        if (!cell.classList.contains('free')) cell.classList.remove('marked');
    });

    updateStats();
}

function drawBall() {
    if (remainingBalls.length === 0) {
        stopGame();
        document.getElementById('ballDisplay').textContent = '¬°Todas las preguntas han sido sorteadas!';
        return;
    }
    const randomIndex = Math.floor(Math.random() * remainingBalls.length);
    const drawnAnswer = remainingBalls.splice(randomIndex, 1)[0];
    const question = literaryQuestions[drawnAnswer];

    drawnBalls.push(drawnAnswer);
    currentQuestion = drawnAnswer; // ahora se espera clic correcto

    document.getElementById('ballDisplay').innerHTML = `<strong>${question}</strong><br><small>Haz clic en la respuesta correcta del cart√≥n</small>`;
    updateDrawnBallsList();
    updateStats();
}

function updateDrawnBallsList() {
    const list = document.getElementById('drawnBallsList');
    list.innerHTML = '';
    drawnBalls.forEach(ans => {
        const el = document.createElement('span');
        el.className = 'ball-item';
        el.textContent = literaryQuestions[ans]; // mostramos la pregunta sorteada
        list.appendChild(el);
    });
}

function checkBingo() {
    const cells = document.querySelectorAll('.bingo-cell');
    let allMarked = true;
    for (const cell of cells) {
        if (!cell.classList.contains('marked') && !cell.classList.contains('free')) {
            allMarked = false; break;
        }
    }
    if (allMarked) {
        celebrateBingo('cart√≥n completo');
    }
}

function celebrateBingo(type) {
    stopGame();
    alert(`¬°üéâ BINGO! ¬°Has completado el ${type}! üéâ`);
    document.getElementById('ballDisplay').textContent = '¬°BINGO! ¬°Cart√≥n completo!';
    document.getElementById('gameBtn').innerHTML = 'üéâ ¬°Ganaste!';
}

function updateStats() {
    document.getElementById('termCount').textContent = Object.keys(literaryQuestions).length;
    const marked = document.querySelectorAll('.bingo-cell.marked').length;
    document.getElementById('markedCount').textContent = marked;
    document.getElementById('drawnCount').textContent = drawnBalls.length;
    document.getElementById('errorCount').textContent = errorCount;
}

function printCard() { window.print(); }

// Inicializar
initializeGame();
</script>
</body>
</html>
