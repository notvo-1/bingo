<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Literario</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
            padding: 40px;
        }

        .bingo-section {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .bingo-controls {
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .bingo-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 3px;
            background: #2c3e50;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .bingo-cell {
            background: white;
            border: 2px solid #ecf0f1;
            padding: 15px 8px;
            text-align: center;
            font-size: 0.85rem;
            font-weight: 600;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 8px;
            line-height: 1.2;
        }

        .bingo-cell:hover {
            background: #f8f9fa;
            transform: scale(1.02);
        }

        .bingo-cell.marked {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border-color: #27ae60;
            transform: scale(0.95);
        }

        .bingo-cell.free {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
            border-color: #95a5a6;
            font-weight: bold;
        }

        .current-ball {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(243, 156, 18, 0.3);
        }

        .current-ball h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .ball-display {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            font-size: 1.3rem;
            font-weight: bold;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .drawn-balls {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .drawn-balls h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .ball-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .ball-item {
            background: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .terms-section {
            display: flex;
            flex-direction: column;
        }

        .terms-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .terms-header h2 {
            color: #2c3e50;
            font-size: 1.8rem;
        }

        .terms-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
            border: 2px solid #ecf0f1;
        }

        .term-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: white;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            transition: all 0.2s ease;
        }

        .term-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transform: translateX(5px);
        }

        .term-input {
            flex: 1;
            border: none;
            background: transparent;
            font-size: 1rem;
            padding: 5px;
            color: #2c3e50;
        }

        .term-input:focus {
            outline: none;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .delete-btn {
            background: #e74c3c;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .delete-btn:hover {
            background: #c0392b;
            transform: scale(1.1);
        }

        .add-term {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .add-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 1rem;
        }

        .add-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .size-controls {
            margin-bottom: 20px;
            text-align: center;
        }

        .size-controls label {
            font-weight: 600;
            color: #2c3e50;
            margin-right: 10px;
        }

        .size-select {
            padding: 8px 15px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
        }

        .stats {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }

        .stats p {
            margin: 5px 0;
            color: #2c3e50;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 30px;
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .bingo-cell {
                font-size: 0.75rem;
                min-height: 60px;
                padding: 8px 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Bingo Literario</h1>
            <p>Juego educativo para explorar el mundo de la literatura</p>
        </div>

        <div class="main-content">
            <div class="bingo-section">
                <div class="bingo-controls">
                    <button class="btn" onclick="generateNewCard()">üé≤ Nueva Tarjeta</button>
                    <button class="btn" id="gameBtn" onclick="startGame()">‚ñ∂Ô∏è Iniciar Juego</button>

                    <button class="btn" onclick="resetGame()">üîÑ Reiniciar Juego</button>
                    <button class="btn" onclick="printCard()">üñ®Ô∏è Imprimir</button>
                </div>

                <div class="current-ball" id="currentBall">
                    <h3>Pr√≥xima pregunta en: <span id="countdown">30</span>s</h3>
                    <div class="ball-display" id="ballDisplay">¬°Presiona "Iniciar Juego"!</div>
                </div>

                <div id="bingoGrid" class="bingo-grid"></div>

                <div class="stats">
                    <p>T√©rminos disponibles: <span id="termCount">49</span></p>
                    <p>Casillas marcadas: <span id="markedCount">0</span></p>
                    <p>Preguntas respondidas: <span id="drawnCount">0</span></p>
                    <p>Errores: <span id="errorCount">0</span>/3</p>
                </div>

                <div class="drawn-balls">
                    <h4>üé± Bolas Sorteadas:</h4>
                    <div class="ball-list" id="drawnBallsList"></div>
                </div>
            </div>

            <div class="terms-section">
                <div class="terms-header">
                    <h2>üìä Cargar Datos desde Excel/Sheets</h2>
                </div>

                <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; border: 2px solid #ecf0f1;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px;">üìã Instrucciones para cargar datos:</h3>
                    <ol style="color: #2c3e50; line-height: 1.6;">
                        <li><strong>Formato requerido:</strong> Archivo CSV con dos columnas</li>
                        <li><strong>Columna A:</strong> Preguntas</li>
                        <li><strong>Columna B:</strong> Respuestas</li>
                        <li><strong>Ejemplo:</strong><br>
                            <code style="background: #e9ecef; padding: 5px; border-radius: 3px;">
                                "¬øQui√©n escribi√≥ Don Quijote?","Cervantes"<br>
                                "¬øCu√°l es la obra de Garc√≠a M√°rquez?","Cien a√±os de soledad"
                            </code>
                        </li>
                    </ol>
                    
                    <div style="margin-top: 20px;">
                        <input type="file" id="csvFile" accept=".csv" style="margin-bottom: 10px; padding: 10px; border: 2px solid #ecf0f1; border-radius: 8px; width: 100%;">
                        <button class="btn" onclick="loadCSV()" style="width: 100%;">üìÇ Cargar Archivo CSV</button>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: #d4edda; border-radius: 8px; border: 1px solid #c3e6cb;">
                        <small style="color: #155724;">
                            üí° <strong>Tip:</strong> Puedes exportar desde Excel o Google Sheets como CSV. 
                            El juego incluye datos de ejemplo que puedes usar inmediatamente.
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentGridSize = 3;
        let literaryQuestions = {
            "Gabriel Garc√≠a M√°rquez": "¬øQui√©n escribi√≥ 'Cien a√±os de soledad'?",
            "Don Quijote": "¬øCu√°l es la obra m√°s famosa de Cervantes?",
            "Realismo m√°gico": "¬øQu√© corriente literaria mezcla lo fant√°stico con lo real?",
            "Met√°fora": "¬øC√≥mo se llama la figura ret√≥rica que compara sin usar 'como'?",
            "Hamlet": "¬øCu√°l es la tragedia m√°s famosa de Shakespeare?",
            "Jorge Luis Borges": "¬øQui√©n escribi√≥ 'El Aleph' y 'Ficciones'?",
            "Cien a√±os de soledad": "¬øCu√°l es la obra cumbre del realismo m√°gico?",
            "Novela": "¬øC√≥mo se llama la narraci√≥n extensa en prosa?",
            "S√≠mil": "¬øQu√© figura ret√≥rica usa 'como' para comparar?",
            "Romeo y Julieta": "¬øCu√°l es la tragedia amorosa m√°s famosa de Shakespeare?",
            "Pablo Neruda": "¬øQui√©n escribi√≥ 'Veinte poemas de amor'?",
            "La Odisea": "¬øCu√°l es el poema √©pico de Homero sobre el regreso de Ulises?",
            "Poes√≠a": "¬øC√≥mo se llama el g√©nero literario que expresa sentimientos en verso?",
            "Hip√©rbole": "¬øQu√© figura ret√≥rica exagera la realidad?",
            "Macbeth": "¬øCu√°l es la tragedia de Shakespeare sobre un rey escoc√©s?",
            "Isabel Allende": "¬øQui√©n escribi√≥ 'La casa de los esp√≠ritus'?",
            "El Principito": "¬øCu√°l es la obra m√°s famosa de Saint-Exup√©ry?",
            "Cuento": "¬øC√≥mo se llama la narraci√≥n breve en prosa?",
            "Personificaci√≥n": "¬øQu√© figura ret√≥rica da cualidades humanas a objetos?",
            "Otelo": "¬øCu√°l es la tragedia de Shakespeare sobre los celos?",
            "Mario Vargas Llosa": "¬øQui√©n escribi√≥ 'La ciudad y los perros'?",
            "1984": "¬øCu√°l es la distop√≠a m√°s famosa de George Orwell?",
            "Ensayo": "¬øC√≥mo se llama el texto reflexivo y argumentativo?",
            "Iron√≠a": "¬øQu√© figura ret√≥rica dice lo contrario de lo que se piensa?",
            "Rey Lear": "¬øCu√°l es la tragedia de Shakespeare sobre un rey y sus hijas?",
            "Octavio Paz": "¬øQui√©n escribi√≥ 'El laberinto de la soledad'?",
            "Rayuela": "¬øCu√°l es la obra m√°s experimental de Julio Cort√°zar?",
            "Drama": "¬øC√≥mo se llama el g√©nero teatral serio?",
            "Aliteraci√≥n": "¬øQu√© figura ret√≥rica repite sonidos conson√°nticos?",
            "Edipo Rey": "¬øCu√°l es la tragedia griega m√°s famosa de S√≥focles?",
            "Julio Cort√°zar": "¬øQui√©n escribi√≥ 'Rayuela' y 'Bestiario'?",
            "Pedro P√°ramo": "¬øCu√°l es la obra m√°s famosa de Juan Rulfo?",
            "L√≠rica": "¬øC√≥mo se llama la poes√≠a que expresa sentimientos √≠ntimos?",
            "Ox√≠moron": "¬øQu√© figura ret√≥rica une conceptos contradictorios?",
            "Ant√≠gona": "¬øCu√°l es la tragedia griega sobre la hija de Edipo?",
            "Carlos Fuentes": "¬øQui√©n escribi√≥ 'La muerte de Artemio Cruz'?",
            "La casa de los esp√≠ritus": "¬øCu√°l es la primera novela de Isabel Allende?",
            "√âpica": "¬øC√≥mo se llama la poes√≠a que narra haza√±as heroicas?",
            "Sin√©cdoque": "¬øQu√© figura ret√≥rica toma la parte por el todo?",
            "Medea": "¬øCu√°l es la tragedia griega sobre la hechicera vengativa?",
            "Rub√©n Dar√≠o": "¬øQui√©n fue el m√°ximo exponente del modernismo hispanoamericano?",
            "Ficciones": "¬øCu√°l es el libro de cuentos m√°s famoso de Borges?",
            "Modernismo": "¬øC√≥mo se llama el movimiento literario de finales del siglo XIX?",
            "Metonimia": "¬øQu√© figura ret√≥rica sustituye una palabra por otra relacionada?",
            "Prometeo": "¬øQui√©n rob√≥ el fuego para d√°rselo a los humanos en la mitolog√≠a?",
            "Sor Juana In√©s": "¬øQui√©n fue la monja poeta del barroco mexicano?",
            "Laberinto de la soledad": "¬øCu√°l es el ensayo m√°s famoso de Octavio Paz?",
            "Barroco": "¬øC√≥mo se llama el movimiento art√≠stico del siglo XVII?",
            "An√°fora": "¬øQu√© figura ret√≥rica repite palabras al inicio de versos?",
            "Electra": "¬øCu√°l es la tragedia griega sobre la venganza filial?"
        };

        let drawnBalls = [];
        let remainingBalls = Object.keys(literaryQuestions);
        let gameInterval = null;
        let isGameRunning = false;
        let currentCard = [];
        let currentQuestion = null;
        let errorCount = 0;
        let maxErrors = 3;

        function initializeGame() {
            generateNewCard();
            updateStats();
        }

        function generateNewCard() {
            const grid = document.getElementById('bingoGrid');
            const totalCells = 9; // 3x3
            
            // Configurar la cuadr√≠cula CSS para 3x3
            grid.style.gridTemplateColumns = `repeat(3, 1fr)`;
            
            // Obtener 8 t√©rminos aleatorios (9 celdas - 1 espacio en blanco)
            const shuffledTerms = [...Object.keys(literaryQuestions)].sort(() => Math.random() - 0.5);
            const selectedTerms = shuffledTerms.slice(0, 8);
            
            // Crear array con t√©rminos y 1 espacio en blanco
            const cardContent = [...selectedTerms, ''];
            
            // Mezclar el contenido para posici√≥n aleatoria del espacio en blanco
            cardContent.sort(() => Math.random() - 0.5);
            
            // Guardar el cart√≥n actual
            currentCard = [...cardContent];
            
            grid.innerHTML = '';
            
            for (let i = 0; i < totalCells; i++) {
                const cell = document.createElement('div');
                cell.className = 'bingo-cell';
                cell.dataset.index = i;
                
                if (cardContent[i] === '') {
                    cell.textContent = '';
                    cell.className += ' free';
                    cell.onclick = null;
                } else {
                    cell.textContent = cardContent[i];
                    cell.onclick = () => toggleCell(cell);
                }
                
                grid.appendChild(cell);
            }
            
            updateStats();
        }

        function toggleCell(cell) {
    if (!currentQuestion) return; // no hay pregunta activa

    if (cell.textContent === currentQuestion) {
        cell.classList.add('marked');
        currentQuestion = null;
    } else {
        errorCount++;
        updateStats();
        if (errorCount >= maxErrors) {
            stopGame();
            alert("‚ùå Has cometido demasiados errores. Fin del juego.");
        }
    }
}


        function startGame() {
            if (remainingBalls.length === 0) {
                resetGame();
            }
            
            isGameRunning = true;
            document.getElementById('gameBtn').innerHTML = '‚è∏Ô∏è Pausar Juego';
            document.getElementById('gameBtn').onclick = stopGame;
            
            // Sortear primera pregunta inmediatamente
            drawBall();
            
            // Configurar intervalo para siguientes preguntas
            let countdown = 30;
            gameInterval = setInterval(() => {
                countdown--;
                document.getElementById('countdown').textContent = countdown;
                
                if (countdown <= 0) {
                    drawBall();
                    countdown = 30;
                }
            }, 1000);
        }

        function stopGame() {
            isGameRunning = false;
            clearInterval(gameInterval);
            document.getElementById('gameBtn').innerHTML = '‚ñ∂Ô∏è Continuar Juego';
            document.getElementById('gameBtn').onclick = startGame;
            document.getElementById('countdown').textContent = '30';
        }

        function resetGame() {
            stopGame();
            drawnBalls = [];
            remainingBalls = [...Object.keys(literaryQuestions)];
            currentQuestion = null;
            errorCount = 0;
            
            document.getElementById('ballDisplay').textContent = '¬°Presiona "Iniciar Juego"!';
            document.getElementById('gameBtn').innerHTML = '‚ñ∂Ô∏è Iniciar Juego';
            document.getElementById('gameBtn').onclick = startGame;
            document.getElementById('drawnBallsList').innerHTML = '';
            
            // Limpiar marcas del cart√≥n
            const cells = document.querySelectorAll('.bingo-cell:not(.free)');
            cells.forEach(cell => cell.classList.remove('marked'));
            
            updateStats();
        }

        function drawBall() {
            if (remainingBalls.length === 0) {
                stopGame();
                document.getElementById('ballDisplay').textContent = '¬°Todas las preguntas han sido respondidas!';
                return;
            }
            
            // Sortear pregunta aleatoria
            const randomIndex = Math.floor(Math.random() * remainingBalls.length);
            const drawnAnswer = remainingBalls.splice(randomIndex, 1)[0];
            const question = literaryQuestions[drawnAnswer];
            
            drawnBalls.push(drawnAnswer);
            currentQuestion = drawnAnswer;
            
            // Mostrar pregunta
            document.getElementById('ballDisplay').innerHTML = `<strong>${question}</strong><br><small>Haz clic en la respuesta correcta del cart√≥n</small>`;
            
            // Marcar autom√°ticamente si est√° en el cart√≥n
            const cells = document.querySelectorAll('.bingo-cell');
            cells.forEach(cell => {
                if (cell.textContent === drawnAnswer && !cell.classList.contains('free')) {
                    cell.classList.add('marked');
                }
            });
            
            // Actualizar lista de preguntas respondidas
            updateDrawnBallsList();
            updateStats();
            checkBingo();
            
            // Reiniciar countdown
            document.getElementById('countdown').textContent = '30';
        }

        function updateDrawnBallsList() {
            const list = document.getElementById('drawnBallsList');
            list.innerHTML = '';
            
            drawnBalls.forEach(ball => {
                const ballElement = document.createElement('span');
                ballElement.className = 'ball-item';
                ballElement.textContent = ball;
                list.appendChild(ballElement);
            });
        }

        function checkBingo() {
            const cells = document.querySelectorAll('.bingo-cell');
            const grid = Array.from(cells);
            
            // Solo verificar cart√≥n completo (3x3)
            let allMarked = true;
            for (let cell of grid) {
                if (!cell.classList.contains('marked') && !cell.classList.contains('free')) {
                    allMarked = false;
                    break;
                }
            }
            if (allMarked) {
                celebrateBingo('cart√≥n completo');
            }
        }

        function celebrateBingo(type) {
            stopGame();
            alert(`¬°üéâ BINGO! ¬°Has completado el ${type}! üéâ`);
            document.getElementById('ballDisplay').textContent = `¬°BINGO! ¬°Cart√≥n completo!`;
            document.getElementById('gameBtn').innerHTML = 'üéâ ¬°Ganaste!';
        }

        function loadCSV() {
            const fileInput = document.getElementById('csvFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Por favor selecciona un archivo CSV');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const csv = e.target.result;
                const lines = csv.split('\n');
                const newQuestions = {};
                
                lines.forEach(line => {
                    if (line.trim()) {
                        // Parsear CSV simple (maneja comillas)
                        const matches = line.match(/^"([^"]+)","([^"]+)"$/) || line.match(/^([^,]+),([^,]+)$/);
                        if (matches) {
                            const question = matches[1].trim();
                            const answer = matches[2].trim();
                            newQuestions[answer] = question;
                        }
                    }
                });
                
                if (Object.keys(newQuestions).length > 0) {
                    literaryQuestions = newQuestions;
                    remainingBalls = [...Object.keys(literaryQuestions)];
                    generateNewCard();
                    updateStats();
                    alert(`‚úÖ Se cargaron ${Object.keys(newQuestions).length} preguntas y respuestas correctamente`);
                } else {
                    alert('‚ùå No se pudieron cargar las preguntas. Verifica el formato del archivo CSV');
                }
            };
            
            reader.readAsText(file);
        }



        function updateStats() {
            document.getElementById('termCount').textContent = Object.keys(literaryQuestions).length;
            const markedCells = document.querySelectorAll('.bingo-cell.marked').length;
            document.getElementById('markedCount').textContent = markedCells;
            document.getElementById('drawnCount').textContent = drawnBalls.length;
            document.getElementById('errorCount').textContent = errorCount;
        }

        function printCard() {
            window.print();
        }



        // Inicializar el juego
        initializeGame();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97683938514ea793',t:'MTc1NjQzMDQwMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
